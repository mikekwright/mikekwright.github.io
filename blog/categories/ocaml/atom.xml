<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: Ocaml | My Fortress of Solitude]]></title>
  <link href="http://www.mikewright.me/blog/categories/ocaml/atom.xml" rel="self"/>
  <link href="http://www.mikewright.me/"/>
  <updated>2014-07-02T09:30:30-06:00</updated>
  <id>http://www.mikewright.me/</id>
  <author>
    <name><![CDATA[Michael Wright]]></name>
    <email><![CDATA[mkwright@gmail.com]]></email>
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Ocaml, Opam and utop from a newb]]></title>
    <link href="http://www.mikewright.me/blog/2013/11/16/ocaml/"/>
    <updated>2013-11-16T15:03:00-07:00</updated>
    <id>http://www.mikewright.me/blog/2013/11/16/ocaml</id>
    <content type="html"><![CDATA[<p>This week I had the chance to attend QCon SF and let me tell you it was a great experience.
One of the benefits that came out of this conference was a free ebook from ORielly books. The
book that I decided to pickup was the newly released <em>Real World Ocaml</em>.</p>

<p>One of the first things that you need to setup when working with ocaml is, of course, the
environment.  This book talks about using utop and opam (the ocaml package manager). So I
decided to install these tools on my system.  There were a few issues that I ran into while
trying to get it working, so I have decided to document those (and what worked in the end)
so that when I setup a new system I don&rsquo;t have to figure them out all over again.</p>

<!-- more -->


<p></p>

<p>For this installation I will be using Ubuntu 13.10 as my OS of choice, however the final
solution is one that should work on any nix system.</p>

<h2>Install from Packages</h2>

<p>This was the first attempt that I had at installing ocaml and opam, using the debian
provided packages.  This had a few issues, the main issue being that opam is not included
in the standard repositories, so they require you to add another repository.</p>

<pre><code>    add-apt-repository ppa:avsm/ppa
    apt-get update
    apt-get install ocaml opam
</code></pre>

<p>This worked to install the basic opam and ocaml systems, except that I already had ocaml
installed, so I had to first remove the original ocaml package</p>

<pre><code>    apt-get remove ocaml
</code></pre>

<p>After that the install above worked to set things up.  But when trying to install a few of
the packages using opam I ran into the issue that the <code>ocaml-compiler-libs</code> was not installed
and trying to install it failed with a version conflict.</p>

<p>At this point I could have tried to dive a little deeper to find out why it failed and
see if I could resolve the package issue, however I prefer to understand how the install
of the different packages goes anyways, so I decided to install from source.</p>

<h2>Install from Source</h2>

<p>I try to install tools from source whenever I get the chance as I really like to understand
what exactly is happening underneath the covers so that if I run into problems in the
future with it running I can have a better starting point.</p>

<p>So to install ocaml and opam from source these are the steps that I went through.</p>

<p><div><script src='https://gist.github.com/7506393.js?file=ocaml-install.sh'></script>
<noscript><pre><code>#!/bin/bash
# Sample of this executing located below
#
# INSTALL_PREFIX=$HOME/Development/ocaml CODE_DIR=$HOME/Development/src ./ocaml-install.sh
#
function installOcaml
{
  local codeDir=$1
  local installDir=$2

  cd $codeDir

  wget http://caml.inria.fr/pub/distrib/ocaml-4.01/ocaml-4.01.0.tar.gz
  tar -xvf ocaml-4.01.0.tar.gz
  cd ocaml-4.01.0
  
  ./configure -prefix $installDir
  make world.opt
  make install

  export PATH=$PATH:$installDir/bin
}

function installOpam
{
  local codeDir=$1
  local installDir=$2

  cd $codeDir

  wget http://www.ocamlpro.com/pub/opam-full-1.1.0.tar.gz
  tar -xvf opam-full-1.1.0.tar.gz
  cd opam-full-1.1.0
  
  ./configure -prefix $installDir
  make
  make install

  $installDir/bin/opam init
  $installDir/bin/opam config setup -a

  echo &quot;. $HOME/.opam/opam-init/init.sh &gt; /dev/null 2&gt; /dev/null || true&quot; &gt;&gt; ~/.bashrc
}

installPrefix=${INSTALL_PREFIX:-&quot;/usr/local&quot;}
codeDir=${CODE_DIR:-&quot;/usr/local/src&quot;}

set -o nounset

installOcaml $codeDir $installPrefix
installOpam $codeDir $installPrefix

echo &quot;Ocaml and Opam now installed, you can install utop by doing the following two things&quot;
echo &quot;&quot;
echo &quot;   1. source $HOME/.opam/opam-init/init.sh&quot;
echo &quot;   2. opam install --yes utop&quot;
</code></pre></noscript></div>
</p>

<h2>All done?</h2>

<p>Well this was just my first day getting setup to go through the Real World Ocaml book, but
I am very, very excited about this book as ocaml was a language that I reported on in school
years ago and found it to be very exciting.</p>
]]></content>
  </entry>
  
</feed>
